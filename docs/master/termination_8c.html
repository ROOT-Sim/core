<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ROOT-Sim core: /home/runner/work/core/core/src/gvt/termination.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="flatdoc.css" rel="stylesheet" type="text/css"/>
<link href="inline-params.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="rs.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ROOT-Sim core
   &#160;<span id="projectnumber">3.0.0-rc.2</span>
   </div>
   <div id="projectbrief">A General-Purpose Multi-threaded Parallel/Distributed Simulation Library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_a60e93a66d81cd0c6df7919d4947f80f.html">gvt</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">termination.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Termination detection module.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;<a class="el" href="termination_8h_source.html">gvt/termination.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="mpi_8h_source.html">distributed/mpi.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="lp_8h_source.html">lp/lp.h</a>&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for termination.c:</div>
<div class="dyncontent">
<div class="center"><img src="termination_8c__incl.png" border="0" usemap="#a_2home_2runner_2work_2core_2core_2src_2gvt_2termination_8c" alt=""/></div>
<map name="a_2home_2runner_2work_2core_2core_2src_2gvt_2termination_8c" id="a_2home_2runner_2work_2core_2core_2src_2gvt_2termination_8c">
<area shape="rect" title="Termination detection module." alt="" coords="163,5,357,47"/>
<area shape="rect" href="termination_8h.html" title="Termination detection module." alt="" coords="133,259,267,285"/>
<area shape="rect" href="lp_8h.html" title="LP construction functions." alt="" coords="378,333,441,360"/>
<area shape="rect" href="mpi_8h.html" title="MPI Support Module." alt="" coords="85,95,219,121"/>
<area shape="rect" href="core_8h.html" title="Core ROOT&#45;Sim functionalities." alt="" coords="319,707,414,733"/>
<area shape="rect" title=" " alt="" coords="236,632,335,659"/>
<area shape="rect" title=" " alt="" coords="347,856,410,883"/>
<area shape="rect" title=" " alt="" coords="145,856,215,883"/>
<area shape="rect" title=" " alt="" coords="240,856,323,883"/>
<area shape="rect" title=" " alt="" coords="625,856,695,883"/>
<area shape="rect" href="ROOT-Sim_8h.html" title="ROOT&#45;Sim header for model development." alt="" coords="405,781,505,808"/>
<area shape="rect" title=" " alt="" coords="435,856,509,883"/>
<area shape="rect" title=" " alt="" coords="533,856,600,883"/>
<area shape="rect" title=" " alt="" coords="889,856,959,883"/>
<area shape="rect" href="platform_8h.html" title="Determine on what OS we are compiling." alt="" coords="961,781,1084,808"/>
<area shape="rect" href="random_8h.html" title="Random Number Generators." alt="" coords="410,632,569,659"/>
<area shape="rect" href="msg_8h.html" title="Message management functions." alt="" coords="286,557,365,584"/>
<area shape="rect" href="process_8h.html" title="LP state management functions." alt="" coords="363,483,463,509"/>
<area shape="rect" href="auto__ckpt_8h.html" title="Autonomic checkpoint interval selection header." alt="" coords="447,408,575,435"/>
<area shape="rect" href="model__allocator_8h.html" title="Memory management functions for simulation models." alt="" coords="649,408,817,435"/>
<area shape="rect" title=" " alt="" coords="812,781,887,808"/>
<area shape="rect" title=" " alt="" coords="645,632,715,659"/>
<area shape="rect" href="array_8h.html" title="Dynamic array datatype." alt="" coords="607,557,742,584"/>
<area shape="rect" href="mm_8h.html" title="Memory Manager main header." alt="" coords="800,632,891,659"/>
<area shape="rect" href="log_8h.html" title="Logging library." alt="" coords="631,707,710,733"/>
<area shape="rect" href="mem_8h.html" title="Platform specific memory utilities." alt="" coords="938,707,1038,733"/>
<area shape="rect" title=" " alt="" coords="487,483,574,509"/>
<area shape="rect" href="multi_8h.html" title="Handling of multiple buddy systems." alt="" coords="759,483,902,509"/>
<area shape="rect" title=" " alt="" coords="767,557,841,584"/>
<area shape="rect" title=" " alt="" coords="866,557,953,584"/>
<area shape="rect" href="control__msg_8h.html" title="MPI remote control messages header." alt="" coords="81,169,223,211"/>
<area shape="rect" href="gvt_8h.html" title="Global Virtual Time." alt="" coords="5,483,85,509"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ac4d9011eb1b4943167ccb1d5e6bbd6bb"><td class="memItemLeft" align="right" valign="top"><a id="ac4d9011eb1b4943167ccb1d5e6bbd6bb"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="termination_8c.html#ac4d9011eb1b4943167ccb1d5e6bbd6bb">termination_global_init</a> (void)</td></tr>
<tr class="memdesc:ac4d9011eb1b4943167ccb1d5e6bbd6bb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the termination detection module node-wide. <br /></td></tr>
<tr class="separator:ac4d9011eb1b4943167ccb1d5e6bbd6bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af5ab1db640b9f40b079dd426485490d5"><td class="memItemLeft" align="right" valign="top"><a id="af5ab1db640b9f40b079dd426485490d5"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="termination_8c.html#af5ab1db640b9f40b079dd426485490d5">termination_lp_init</a> (struct <a class="el" href="structlp__ctx.html">lp_ctx</a> *lp)</td></tr>
<tr class="memdesc:af5ab1db640b9f40b079dd426485490d5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the termination detection module LP-wide. <br /></td></tr>
<tr class="separator:af5ab1db640b9f40b079dd426485490d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e2b016baea72fd9b0f3dbd5847c8d48"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="termination_8c.html#a5e2b016baea72fd9b0f3dbd5847c8d48">termination_on_msg_process</a> (struct <a class="el" href="structlp__ctx.html">lp_ctx</a> *lp, <a class="el" href="ROOT-Sim_8h.html#a8f79ad6880e99acb4edd079069847d9d">simtime_t</a> msg_time)</td></tr>
<tr class="memdesc:a5e2b016baea72fd9b0f3dbd5847c8d48"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute termination operations after a new message has been processed.  <a href="termination_8c.html#a5e2b016baea72fd9b0f3dbd5847c8d48">More...</a><br /></td></tr>
<tr class="separator:a5e2b016baea72fd9b0f3dbd5847c8d48"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4fe62eb553d7030cc9e1697f57f008e5"><td class="memItemLeft" align="right" valign="top"><a id="a4fe62eb553d7030cc9e1697f57f008e5"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="termination_8c.html#a4fe62eb553d7030cc9e1697f57f008e5">termination_on_ctrl_msg</a> (void)</td></tr>
<tr class="memdesc:a4fe62eb553d7030cc9e1697f57f008e5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute termination operations after the receipt of a termination control message. <br /></td></tr>
<tr class="separator:a4fe62eb553d7030cc9e1697f57f008e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3935a5503667e9c5d9a802c38f1ba50b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="termination_8c.html#a3935a5503667e9c5d9a802c38f1ba50b">termination_on_gvt</a> (<a class="el" href="ROOT-Sim_8h.html#a8f79ad6880e99acb4edd079069847d9d">simtime_t</a> current_gvt)</td></tr>
<tr class="memdesc:a3935a5503667e9c5d9a802c38f1ba50b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update the termination module state after a GVT computation.  <a href="termination_8c.html#a3935a5503667e9c5d9a802c38f1ba50b">More...</a><br /></td></tr>
<tr class="separator:a3935a5503667e9c5d9a802c38f1ba50b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb16759c0ebb79f662bd12a84f97b2d1"><td class="memItemLeft" align="right" valign="top"><a id="afb16759c0ebb79f662bd12a84f97b2d1"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="termination_8c.html#afb16759c0ebb79f662bd12a84f97b2d1">RootsimStop</a> (void)</td></tr>
<tr class="memdesc:afb16759c0ebb79f662bd12a84f97b2d1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Force termination of the simulation. <br /></td></tr>
<tr class="separator:afb16759c0ebb79f662bd12a84f97b2d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5eb6c308f4b8ea6cbdf5796e9e29522d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="termination_8c.html#a5eb6c308f4b8ea6cbdf5796e9e29522d">termination_on_lp_rollback</a> (struct <a class="el" href="structlp__ctx.html">lp_ctx</a> *lp, <a class="el" href="ROOT-Sim_8h.html#a8f79ad6880e99acb4edd079069847d9d">simtime_t</a> msg_time)</td></tr>
<tr class="memdesc:a5eb6c308f4b8ea6cbdf5796e9e29522d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute termination operations after a LP has been rollbacked.  <a href="termination_8c.html#a5eb6c308f4b8ea6cbdf5796e9e29522d">More...</a><br /></td></tr>
<tr class="separator:a5eb6c308f4b8ea6cbdf5796e9e29522d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:add53767828129ccccc37c7d29c605113"><td class="memItemLeft" align="right" valign="top"><a id="add53767828129ccccc37c7d29c605113"></a>
_Atomic <a class="el" href="core_8h.html#a6bbc54689d56c687d66a8e5b3374dfae">nid_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="termination_8c.html#add53767828129ccccc37c7d29c605113">nodes_to_end</a></td></tr>
<tr class="memdesc:add53767828129ccccc37c7d29c605113"><td class="mdescLeft">&#160;</td><td class="mdescRight">The number of nodes that still need to continue running the simulation. <br /></td></tr>
<tr class="separator:add53767828129ccccc37c7d29c605113"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b79937443bf8a36a6f0e94916835eed"><td class="memItemLeft" align="right" valign="top"><a id="a4b79937443bf8a36a6f0e94916835eed"></a>
static _Atomic <a class="el" href="core_8h.html#abbbb4962846f86af8e54d514d1b348a9">rid_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="termination_8c.html#a4b79937443bf8a36a6f0e94916835eed">thr_to_end</a></td></tr>
<tr class="memdesc:a4b79937443bf8a36a6f0e94916835eed"><td class="mdescLeft">&#160;</td><td class="mdescRight">The number of local threads that still need to continue running the simulation. <br /></td></tr>
<tr class="separator:a4b79937443bf8a36a6f0e94916835eed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5b6aa00b291a1b2ea1b58a144df586c"><td class="memItemLeft" align="right" valign="top"><a id="aa5b6aa00b291a1b2ea1b58a144df586c"></a>
static __thread uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="termination_8c.html#aa5b6aa00b291a1b2ea1b58a144df586c">lps_to_end</a></td></tr>
<tr class="memdesc:aa5b6aa00b291a1b2ea1b58a144df586c"><td class="mdescLeft">&#160;</td><td class="mdescRight">The number of thread-locally bounded LPs that still need to continue running the simulation. <br /></td></tr>
<tr class="separator:aa5b6aa00b291a1b2ea1b58a144df586c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a706281c30d24ca55b40c43c44d3cf3eb"><td class="memItemLeft" align="right" valign="top">static __thread <a class="el" href="ROOT-Sim_8h.html#a8f79ad6880e99acb4edd079069847d9d">simtime_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="termination_8c.html#a706281c30d24ca55b40c43c44d3cf3eb">max_t</a></td></tr>
<tr class="memdesc:a706281c30d24ca55b40c43c44d3cf3eb"><td class="mdescLeft">&#160;</td><td class="mdescRight">The maximum speculative time at which a thread-local LP declared its intention to terminate.  <a href="termination_8c.html#a706281c30d24ca55b40c43c44d3cf3eb">More...</a><br /></td></tr>
<tr class="separator:a706281c30d24ca55b40c43c44d3cf3eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Termination detection module. </p>
<dl class="section copyright"><dt>Copyright</dt><dd>Copyright (C) 2008-2022 HPDCS Group <a href="https://hpdcs.github.io">https://hpdcs.github.io</a> </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a3935a5503667e9c5d9a802c38f1ba50b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3935a5503667e9c5d9a802c38f1ba50b">&#9670;&nbsp;</a></span>termination_on_gvt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void termination_on_gvt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="ROOT-Sim_8h.html#a8f79ad6880e99acb4edd079069847d9d">simtime_t</a>&#160;</td>
          <td class="paramname"><em>current_gvt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Update the termination module state after a GVT computation. </p>
<p>Here we check if the simulation, from the point of view of the current thread, can be terminated. If also all the other processing threads on the node are willing to end the simulation, a termination control message is broadcast to the other nodes. </p>

</div>
</div>
<a id="a5eb6c308f4b8ea6cbdf5796e9e29522d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5eb6c308f4b8ea6cbdf5796e9e29522d">&#9670;&nbsp;</a></span>termination_on_lp_rollback()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void termination_on_lp_rollback </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structlp__ctx.html">lp_ctx</a> *&#160;</td>
          <td class="paramname"><em>lp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ROOT-Sim_8h.html#a8f79ad6880e99acb4edd079069847d9d">simtime_t</a>&#160;</td>
          <td class="paramname"><em>msg_time</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute termination operations after a LP has been rollbacked. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">msg_time</td><td>the timestamp of the straggler or anti message which caused the rollback </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a5e2b016baea72fd9b0f3dbd5847c8d48"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5e2b016baea72fd9b0f3dbd5847c8d48">&#9670;&nbsp;</a></span>termination_on_msg_process()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void termination_on_msg_process </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structlp__ctx.html">lp_ctx</a> *&#160;</td>
          <td class="paramname"><em>lp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ROOT-Sim_8h.html#a8f79ad6880e99acb4edd079069847d9d">simtime_t</a>&#160;</td>
          <td class="paramname"><em>msg_time</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute termination operations after a new message has been processed. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">msg_time</td><td>the timestamp of the freshly processed message </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a706281c30d24ca55b40c43c44d3cf3eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a706281c30d24ca55b40c43c44d3cf3eb">&#9670;&nbsp;</a></span>max_t</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">__thread <a class="el" href="ROOT-Sim_8h.html#a8f79ad6880e99acb4edd079069847d9d">simtime_t</a> max_t</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The maximum speculative time at which a thread-local LP declared its intention to terminate. </p>
<p>FIXME: a wrong high termination time during a speculative trajectory forces the simulation to uselessly continue </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
